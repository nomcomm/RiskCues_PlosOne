test_data$CUE62_Set8_Dark..vs..well.lit..background_Abstract_0 <- NULL
test_data$No <- NULL
test_data$Sex <- NULL
test_data$BildNr <- NULL
test_data$Trust <- NULL
test_data$Health <- NULL
test_data$Attractiveness <- NULL
test_data$CUE35_GenImp1_Self.confident..vs..not._Abstract_2=NULL
test_data$CUE36_GenImp2_Cautious..vs..risk.seeking._Abstract_2=NULL
test_data$CUE37_GenImp3_Uneducated..vs..educated._Abstract_2=NULL
test_data$CUE38_GenImp4_Southern..vs..nordic..type_Abstract_1=NULL
test_data$CUE39_GenImp5_Sporty..vs..unsporty._Abstract_2=NULL
test_data$CUE40_GenImp6_Scruffy..vs..kempt._Abstract_2=NULL
test_data$CUE41_GenImp7_Likeable..vs..unsympathetic._Abstract_2=NULL
test_data$CUE42_GenImp8_Attractive..vs..unattractive._Abstract_2=NULL
test_data$CUE43_GenImp9_Irresponsible..vs..responsible._Abstract_2=NULL
test_data$CUE44_GenImp10_Homosexual..vs..heterosexual._Abstract_2=NULL
test_data$CUE45_GenImp11_Popular..vs..unpopular._Abstract_2=NULL
test_data$CUE46_GenImp12_Selfish..vs..unselfish._Abstract_2=NULL
test_data$CUE47_GenImp13_Ill.looking..vs..healthy.looking._Abstract_2=NULL
#```{r warning=FALSE}
X_test <- as.matrix(test_data[,2:57])
X_test <- as.data.frame(X_test)
pred_values <- predict.lm(RegModel.reduced, X_test);
# How well do the predicted data (predicted HIV risk) correlate with the measured data (veridical HIV risk)? In other words, how good does our prediction fit with what we actually observe?
cor.test(test_data$Risk, pred_values);
# Visualize the prediction as a scatterplot.
qplot(test_data$Risk, pred_values, xlab = "Actual HIV Risk", ylab = "Predicted HIV Risk",
xlim = c(1,7), ylim = c(1,7), asp = 1) +
theme(text = element_text(size=20))
#pred_values <- predict.lm(RegModel.full, X_test);
#cor.test(test_data$Risk, pred_values);
rm(test_data, X_test, pred_values, coefficients.reduced, coefficients.full, corrs, RegModel.full, RegModel.reduced)
test_data = read.csv("setB_121-240.txt", header =TRUE, sep = "\t");
test_data$CUE3_Appearance3_Unshaved..vs..shaved._Abstract_0 <- NULL
test_data$CUE34_Face17_Strong..vs..no..growth.of.beard_Abstract_0 <- NULL
test_data$CUE53_Mouth2_Yellow..vs..white..teeth_Abstract_0 <- NULL
test_data$CUE62_Set8_Dark..vs..well.lit..background_Abstract_0 <- NULL
test_data$No <- NULL
test_data$Sex <- NULL
test_data$BildNr <- NULL
test_data$Trust <- NULL
test_data$Health <- NULL
test_data$Attractiveness <- NULL
test_data$CUE35_GenImp1_Self.confident..vs..not._Abstract_2=NULL
test_data$CUE36_GenImp2_Cautious..vs..risk.seeking._Abstract_2=NULL
test_data$CUE37_GenImp3_Uneducated..vs..educated._Abstract_2=NULL
test_data$CUE38_GenImp4_Southern..vs..nordic..type_Abstract_1=NULL
test_data$CUE39_GenImp5_Sporty..vs..unsporty._Abstract_2=NULL
test_data$CUE40_GenImp6_Scruffy..vs..kempt._Abstract_2=NULL
test_data$CUE41_GenImp7_Likeable..vs..unsympathetic._Abstract_2=NULL
test_data$CUE42_GenImp8_Attractive..vs..unattractive._Abstract_2=NULL
test_data$CUE43_GenImp9_Irresponsible..vs..responsible._Abstract_2=NULL
test_data$CUE44_GenImp10_Homosexual..vs..heterosexual._Abstract_2=NULL
test_data$CUE45_GenImp11_Popular..vs..unpopular._Abstract_2=NULL
test_data$CUE46_GenImp12_Selfish..vs..unselfish._Abstract_2=NULL
test_data$CUE47_GenImp13_Ill.looking..vs..healthy.looking._Abstract_2=NULL
library('lars')
y_train <- as.matrix(train_data[,1])
X_train <- as.matrix(train_data[,2:57])
fit <- lars(X_train, y_train, type="lasso")
#summary(fit)
best_step <- fit$df[which.min(fit$RSS)] # select a step with a minimum error
X_test <- as.matrix(test_data[,2:57])  # make predictions
predictions_all <- predict(fit, X_test, s=best_step, type="fit")
cor.test(test_data$Risk, predictions_all$fit); # summarize accuracy
qplot(test_data$Risk, predictions_all$fit, xlab = "Actual HIV Risk", ylab = "Predicted HIV Risk",
xlim = c(1,7), ylim = c(1,7), asp = 1) +
theme(text = element_text(size=20))
#rmse <- mean((y - predictions)^2)
#print(rmse)
#lasso_coefs = data.frame(coef(fit, s=best_step))
#class_coefs = data.frame(coef(RegModel.full))
#class_coefs = data.frame(class_coefs[-1,])
#de = data.frame(lasso_coefs$coef.fit..s...best_step., class_coefs$class_coefs..1...)
#cor(de)
#qplot(de$lasso_coefs.coef.fit..s...best_step., de$class_coefs.class_coefs..1...,
#      xlab = "l", ylab = "c", asp = 1) +
#      theme(text = element_text(size=20))
test_data = read.csv("setB_121-240.txt", header =TRUE, sep = "\t");
test_data$CUE3_Appearance3_Unshaved..vs..shaved._Abstract_0 <- NULL
test_data$CUE34_Face17_Strong..vs..no..growth.of.beard_Abstract_0 <- NULL
test_data$CUE53_Mouth2_Yellow..vs..white..teeth_Abstract_0 <- NULL
test_data$CUE62_Set8_Dark..vs..well.lit..background_Abstract_0 <- NULL
test_data$No <- NULL
test_data$Sex <- NULL
test_data$BildNr <- NULL
test_data$Trust <- NULL
test_data$Health <- NULL
test_data$Attractiveness <- NULL
test_data$CUE35_GenImp1_Self.confident..vs..not._Abstract_2=NULL
test_data$CUE36_GenImp2_Cautious..vs..risk.seeking._Abstract_2=NULL
test_data$CUE37_GenImp3_Uneducated..vs..educated._Abstract_2=NULL
test_data$CUE38_GenImp4_Southern..vs..nordic..type_Abstract_1=NULL
test_data$CUE39_GenImp5_Sporty..vs..unsporty._Abstract_2=NULL
test_data$CUE40_GenImp6_Scruffy..vs..kempt._Abstract_2=NULL
test_data$CUE41_GenImp7_Likeable..vs..unsympathetic._Abstract_2=NULL
test_data$CUE42_GenImp8_Attractive..vs..unattractive._Abstract_2=NULL
test_data$CUE43_GenImp9_Irresponsible..vs..responsible._Abstract_2=NULL
test_data$CUE44_GenImp10_Homosexual..vs..heterosexual._Abstract_2=NULL
test_data$CUE45_GenImp11_Popular..vs..unpopular._Abstract_2=NULL
test_data$CUE46_GenImp12_Selfish..vs..unselfish._Abstract_2=NULL
test_data$CUE47_GenImp13_Ill.looking..vs..healthy.looking._Abstract_2=NULL
library('lars')
y_train <- as.matrix(train_data[,1])
X_train <- as.matrix(train_data[,2:57])
fit <- lars(X_train, y_train, type="lasso")
#summary(fit)
best_step <- fit$df[which.min(fit$RSS)] # select a step with a minimum error
X_test <- as.matrix(test_data[,2:57])  # make predictions
predictions_all <- predict(fit, X_test, s=best_step, type="fit")
cor.test(test_data$Risk, predictions_all$fit); # summarize accuracy
qplot(test_data$Risk, predictions_all$fit, xlab = "Actual HIV Risk", ylab = "Predicted HIV Risk",
xlim = c(1,7), ylim = c(1,7), asp = 1) +
theme(text = element_text(size=20))
#rmse <- mean((y - predictions)^2)
#print(rmse)
#lasso_coefs = data.frame(coef(fit, s=best_step))
#class_coefs = data.frame(coef(RegModel.full))
#class_coefs = data.frame(class_coefs[-1,])
#de = data.frame(lasso_coefs$coef.fit..s...best_step., class_coefs$class_coefs..1...)
#cor(de)
#qplot(de$lasso_coefs.coef.fit..s...best_step., de$class_coefs.class_coefs..1...,
#      xlab = "l", ylab = "c", asp = 1) +
#      theme(text = element_text(size=20))
rm(list = ls())
setwd("/Users/Ralf/My_Cloud/RalfsFunctions/GITHUB/nomcomm/riskcues/data")
library(foreign) # gives read.spss function
library("ggplot2")
train_data = read.csv("setA_001-120.txt", header =TRUE, sep = "\t");
train_data$CUE3_Appearance3_Unshaved..vs..shaved._Abstract_0 <- NULL
train_data$CUE34_Face17_Strong..vs..no..growth.of.beard_Abstract_0 <- NULL
train_data$CUE53_Mouth2_Yellow..vs..white..teeth_Abstract_0 <- NULL
train_data$CUE62_Set8_Dark..vs..well.lit..background_Abstract_0 <- NULL
train_data$No <- NULL
train_data$Sex <- NULL
train_data$BildNr <- NULL
train_data$Trust <- NULL
train_data$Health <- NULL
train_data$Attractiveness <- NULL
train_data$CUE35_GenImp1_Self.confident..vs..not._Abstract_2=NULL
train_data$CUE36_GenImp2_Cautious..vs..risk.seeking._Abstract_2=NULL
train_data$CUE37_GenImp3_Uneducated..vs..educated._Abstract_2=NULL
train_data$CUE38_GenImp4_Southern..vs..nordic..type_Abstract_1=NULL
train_data$CUE39_GenImp5_Sporty..vs..unsporty._Abstract_2=NULL
train_data$CUE40_GenImp6_Scruffy..vs..kempt._Abstract_2=NULL
train_data$CUE41_GenImp7_Likeable..vs..unsympathetic._Abstract_2=NULL
train_data$CUE42_GenImp8_Attractive..vs..unattractive._Abstract_2=NULL
train_data$CUE43_GenImp9_Irresponsible..vs..responsible._Abstract_2=NULL
train_data$CUE44_GenImp10_Homosexual..vs..heterosexual._Abstract_2=NULL
train_data$CUE45_GenImp11_Popular..vs..unpopular._Abstract_2=NULL
train_data$CUE46_GenImp12_Selfish..vs..unselfish._Abstract_2=NULL
train_data$CUE47_GenImp13_Ill.looking..vs..healthy.looking._Abstract_2=NULL
colnames(train_data)
corrs <- cor(train_data)
test_data = read.csv("setB_121-240.txt", header =TRUE, sep = "\t");
train_data = read.csv("setA_001-120.txt", header =TRUE, sep = "\t");
train_data$CUE3_Appearance3_Unshaved..vs..shaved._Abstract_0 <- NULL
train_data$CUE34_Face17_Strong..vs..no..growth.of.beard_Abstract_0 <- NULL
train_data$CUE53_Mouth2_Yellow..vs..white..teeth_Abstract_0 <- NULL
train_data$CUE62_Set8_Dark..vs..well.lit..background_Abstract_0 <- NULL
train_data$No <- NULL
train_data$Sex <- NULL
train_data$BildNr <- NULL
train_data$Trust <- NULL
train_data$Health <- NULL
train_data$Attractiveness <- NULL
train_data$CUE35_GenImp1_Self.confident..vs..not._Abstract_2=NULL
train_data$CUE36_GenImp2_Cautious..vs..risk.seeking._Abstract_2=NULL
train_data$CUE37_GenImp3_Uneducated..vs..educated._Abstract_2=NULL
train_data$CUE38_GenImp4_Southern..vs..nordic..type_Abstract_1=NULL
train_data$CUE39_GenImp5_Sporty..vs..unsporty._Abstract_2=NULL
train_data$CUE40_GenImp6_Scruffy..vs..kempt._Abstract_2=NULL
train_data$CUE41_GenImp7_Likeable..vs..unsympathetic._Abstract_2=NULL
train_data$CUE42_GenImp8_Attractive..vs..unattractive._Abstract_2=NULL
train_data$CUE43_GenImp9_Irresponsible..vs..responsible._Abstract_2=NULL
train_data$CUE44_GenImp10_Homosexual..vs..heterosexual._Abstract_2=NULL
train_data$CUE45_GenImp11_Popular..vs..unpopular._Abstract_2=NULL
train_data$CUE46_GenImp12_Selfish..vs..unselfish._Abstract_2=NULL
train_data$CUE47_GenImp13_Ill.looking..vs..healthy.looking._Abstract_2=NULL
RegModel.reduced <-
lm(Risk~CUE2_Appearance2_Lot.of..vs..no..body.adornment_Abstract_0 +
CUE8_Appearance8_Dark..vs..bright..clothes_Abstract_0+
CUE12_Body3_Overweight..vs..underweight._Abstract_0+
CUE15_Eyes1_Dark..vs..no.dark..rings.under.eyes_Abstract_0+
CUE16_Eyes2_Reddened..vs..non.reddened..eyes_Abstract_0+
CUE17_Eyes3_Dark..vs..bright..eyes_Abstract_0+
CUE26_Face9_Red..vs..pale..cheeks_Abstract_0+
CUE54_Mouth3_Full..vs..narrow..lips_Abstract_0+
CUE55_Set1_Pallid..vs..colorful..background_Abstract_0+
CUE57_Set3_Alcohol..vs..no.alcohol..visible_Abstract_0+
CUE58_Set4_Picture.taken.inside..vs..outside._Abstract_0+
CUE60_Set6_Cigarettes..vs..no.cigarettes..visible_Abstract_0+
CUE65_Skin2_Pale..vs..tanned..skin_Abstract_0+CUE68_Skin5_Spotty..vs..spot.free..skin_Abstract_0+
CUE69_Skin6_Greasy..vs..dry..skin_Abstract_0+CUE72_View2_Averted..vs..front.facing..gaze_Abstract_0,
data=train_data)
#summary(RegModel.1)
coefficients.reduced = coef(RegModel.reduced)
test_data = read.csv("setB_121-240.txt", header =TRUE, sep = "\t");
test_data$CUE3_Appearance3_Unshaved..vs..shaved._Abstract_0 <- NULL
test_data$CUE34_Face17_Strong..vs..no..growth.of.beard_Abstract_0 <- NULL
test_data$CUE53_Mouth2_Yellow..vs..white..teeth_Abstract_0 <- NULL
test_data$CUE62_Set8_Dark..vs..well.lit..background_Abstract_0 <- NULL
test_data$No <- NULL
test_data$Sex <- NULL
test_data$BildNr <- NULL
test_data$Trust <- NULL
test_data$Health <- NULL
test_data$Attractiveness <- NULL
test_data$CUE35_GenImp1_Self.confident..vs..not._Abstract_2=NULL
test_data$CUE36_GenImp2_Cautious..vs..risk.seeking._Abstract_2=NULL
test_data$CUE37_GenImp3_Uneducated..vs..educated._Abstract_2=NULL
test_data$CUE38_GenImp4_Southern..vs..nordic..type_Abstract_1=NULL
test_data$CUE39_GenImp5_Sporty..vs..unsporty._Abstract_2=NULL
test_data$CUE40_GenImp6_Scruffy..vs..kempt._Abstract_2=NULL
test_data$CUE41_GenImp7_Likeable..vs..unsympathetic._Abstract_2=NULL
test_data$CUE42_GenImp8_Attractive..vs..unattractive._Abstract_2=NULL
test_data$CUE43_GenImp9_Irresponsible..vs..responsible._Abstract_2=NULL
test_data$CUE44_GenImp10_Homosexual..vs..heterosexual._Abstract_2=NULL
test_data$CUE45_GenImp11_Popular..vs..unpopular._Abstract_2=NULL
test_data$CUE46_GenImp12_Selfish..vs..unselfish._Abstract_2=NULL
test_data$CUE47_GenImp13_Ill.looking..vs..healthy.looking._Abstract_2=NULL
#```{r warning=FALSE}
X_test <- as.matrix(test_data[,2:57])
X_test <- as.data.frame(X_test)
pred_values <- predict.lm(RegModel.reduced, X_test);
# How well do the predicted data (predicted HIV risk) correlate with the measured data (veridical HIV risk)? In other words, how good does our prediction fit with what we actually observe?
cor.test(test_data$Risk, pred_values);
# Visualize the prediction as a scatterplot.
qplot(test_data$Risk, pred_values, xlab = "Actual HIV Risk", ylab = "Predicted HIV Risk",
xlim = c(1,7), ylim = c(1,7), asp = 1) +
theme(text = element_text(size=20))
rm(test_data, X_test, pred_values, coefficients.reduced, coefficients.full, corrs, RegModel.full, RegModel.reduced)
rm(test_data, X_test, pred_values, coefficients.reduced, coefficients.full, corrs,  RegModel.reduced)
train_data = read.csv("setA_001-120.txt", header =TRUE, sep = "\t");
train_data$CUE3_Appearance3_Unshaved..vs..shaved._Abstract_0 <- NULL
train_data$CUE34_Face17_Strong..vs..no..growth.of.beard_Abstract_0 <- NULL
train_data$CUE53_Mouth2_Yellow..vs..white..teeth_Abstract_0 <- NULL
train_data$CUE62_Set8_Dark..vs..well.lit..background_Abstract_0 <- NULL
train_data$No <- NULL
train_data$Sex <- NULL
train_data$BildNr <- NULL
train_data$Trust <- NULL
train_data$Health <- NULL
train_data$Attractiveness <- NULL
train_data$CUE35_GenImp1_Self.confident..vs..not._Abstract_2=NULL
train_data$CUE36_GenImp2_Cautious..vs..risk.seeking._Abstract_2=NULL
train_data$CUE37_GenImp3_Uneducated..vs..educated._Abstract_2=NULL
train_data$CUE38_GenImp4_Southern..vs..nordic..type_Abstract_1=NULL
train_data$CUE39_GenImp5_Sporty..vs..unsporty._Abstract_2=NULL
train_data$CUE40_GenImp6_Scruffy..vs..kempt._Abstract_2=NULL
train_data$CUE41_GenImp7_Likeable..vs..unsympathetic._Abstract_2=NULL
train_data$CUE42_GenImp8_Attractive..vs..unattractive._Abstract_2=NULL
train_data$CUE43_GenImp9_Irresponsible..vs..responsible._Abstract_2=NULL
train_data$CUE44_GenImp10_Homosexual..vs..heterosexual._Abstract_2=NULL
train_data$CUE45_GenImp11_Popular..vs..unpopular._Abstract_2=NULL
train_data$CUE46_GenImp12_Selfish..vs..unselfish._Abstract_2=NULL
train_data$CUE47_GenImp13_Ill.looking..vs..healthy.looking._Abstract_2=NULL
RegModel.reduced <-
lm(Risk~CUE2_Appearance2_Lot.of..vs..no..body.adornment_Abstract_0 +
CUE4_Appearance4_Worn.out..vs..intact..clothes_Abstract_1+
CUE5_Appearance5_Provocative..vs..reserved..clothes_Abstract_1+
CUE6_Appearance6_Unconventional..vs..conventional..appearance_Abstract_1+
CUE8_Appearance8_Dark..vs..bright..clothes_Abstract_0+
CUE10_Body1_Tense..vs..relaxed..posture_Abstract_1+
CUE12_Body3_Overweight..vs..underweight._Abstract_0+
CUE15_Eyes1_Dark..vs..no.dark..rings.under.eyes_Abstract_0+
CUE16_Eyes2_Reddened..vs..non.reddened..eyes_Abstract_0+
CUE17_Eyes3_Dark..vs..bright..eyes_Abstract_0+
CUE18_Face1_Happy..vs..sad..expression_Abstract_1+
CUE19_Face2_Babyish..vs..mature..Face_Abstract_1+
CUE20_Face3_Feminine..vs..masculine..face_Abstract_1+
CUE25_Face8_Ugly..vs..beautiful..face_Abstract_1+
CUE26_Face9_Red..vs..pale..cheeks_Abstract_0+
CUE54_Mouth3_Full..vs..narrow..lips_Abstract_0+
CUE55_Set1_Pallid..vs..colorful..background_Abstract_0+
CUE56_Set2_Unorganized..vs..organized..background_Abstract_1+
CUE57_Set3_Alcohol..vs..no.alcohol..visible_Abstract_0+
CUE58_Set4_Picture.taken.inside..vs..outside._Abstract_0+
CUE60_Set6_Cigarettes..vs..no.cigarettes..visible_Abstract_0+
CUE65_Skin2_Pale..vs..tanned..skin_Abstract_0+CUE68_Skin5_Spotty..vs..spot.free..skin_Abstract_0+
CUE69_Skin6_Greasy..vs..dry..skin_Abstract_0+CUE72_View2_Averted..vs..front.facing..gaze_Abstract_0,
data=train_data)
#summary(RegModel.1)
coefficients.reduced = coef(RegModel.reduced)
# we could also use the full model with all cues, but that would be not advisable due to the large number of cues and collinearities
RegModel.full <- lm(Risk~., data=train_data)
coefficients.full = data.frame(coef(RegModel.full))
test_data = read.csv("setB_121-240.txt", header =TRUE, sep = "\t");
test_data$CUE3_Appearance3_Unshaved..vs..shaved._Abstract_0 <- NULL
test_data$CUE34_Face17_Strong..vs..no..growth.of.beard_Abstract_0 <- NULL
test_data$CUE53_Mouth2_Yellow..vs..white..teeth_Abstract_0 <- NULL
test_data$CUE62_Set8_Dark..vs..well.lit..background_Abstract_0 <- NULL
test_data$No <- NULL
test_data$Sex <- NULL
test_data$BildNr <- NULL
test_data$Trust <- NULL
test_data$Health <- NULL
test_data$Attractiveness <- NULL
test_data$CUE35_GenImp1_Self.confident..vs..not._Abstract_2=NULL
test_data$CUE36_GenImp2_Cautious..vs..risk.seeking._Abstract_2=NULL
test_data$CUE37_GenImp3_Uneducated..vs..educated._Abstract_2=NULL
test_data$CUE38_GenImp4_Southern..vs..nordic..type_Abstract_1=NULL
test_data$CUE39_GenImp5_Sporty..vs..unsporty._Abstract_2=NULL
test_data$CUE40_GenImp6_Scruffy..vs..kempt._Abstract_2=NULL
test_data$CUE41_GenImp7_Likeable..vs..unsympathetic._Abstract_2=NULL
test_data$CUE42_GenImp8_Attractive..vs..unattractive._Abstract_2=NULL
test_data$CUE43_GenImp9_Irresponsible..vs..responsible._Abstract_2=NULL
test_data$CUE44_GenImp10_Homosexual..vs..heterosexual._Abstract_2=NULL
test_data$CUE45_GenImp11_Popular..vs..unpopular._Abstract_2=NULL
test_data$CUE46_GenImp12_Selfish..vs..unselfish._Abstract_2=NULL
test_data$CUE47_GenImp13_Ill.looking..vs..healthy.looking._Abstract_2=NULL
#```{r warning=FALSE}
X_test <- as.matrix(test_data[,2:57])
X_test <- as.data.frame(X_test)
pred_values <- predict.lm(RegModel.reduced, X_test);
# How well do the predicted data (predicted HIV risk) correlate with the measured data (veridical HIV risk)? In other words, how good does our prediction fit with what we actually observe?
cor.test(test_data$Risk, pred_values);
# Visualize the prediction as a scatterplot.
qplot(test_data$Risk, pred_values, xlab = "Actual HIV Risk", ylab = "Predicted HIV Risk",
xlim = c(1,7), ylim = c(1,7), asp = 1) +
theme(text = element_text(size=20))
#pred_values <- predict.lm(RegModel.full, X_test);
#cor.test(test_data$Risk, pred_values);
rm(test_data, X_test, pred_values, coefficients.reduced, coefficients.full, corrs, RegModel.full, RegModel.reduced)
test_data = read.csv("setB_121-240.txt", header =TRUE, sep = "\t");
test_data$CUE3_Appearance3_Unshaved..vs..shaved._Abstract_0 <- NULL
test_data$CUE34_Face17_Strong..vs..no..growth.of.beard_Abstract_0 <- NULL
test_data$CUE53_Mouth2_Yellow..vs..white..teeth_Abstract_0 <- NULL
test_data$CUE62_Set8_Dark..vs..well.lit..background_Abstract_0 <- NULL
test_data$No <- NULL
test_data$Sex <- NULL
test_data$BildNr <- NULL
test_data$Trust <- NULL
test_data$Health <- NULL
test_data$Attractiveness <- NULL
test_data$CUE35_GenImp1_Self.confident..vs..not._Abstract_2=NULL
test_data$CUE36_GenImp2_Cautious..vs..risk.seeking._Abstract_2=NULL
test_data$CUE37_GenImp3_Uneducated..vs..educated._Abstract_2=NULL
test_data$CUE38_GenImp4_Southern..vs..nordic..type_Abstract_1=NULL
test_data$CUE39_GenImp5_Sporty..vs..unsporty._Abstract_2=NULL
test_data$CUE40_GenImp6_Scruffy..vs..kempt._Abstract_2=NULL
test_data$CUE41_GenImp7_Likeable..vs..unsympathetic._Abstract_2=NULL
test_data$CUE42_GenImp8_Attractive..vs..unattractive._Abstract_2=NULL
test_data$CUE43_GenImp9_Irresponsible..vs..responsible._Abstract_2=NULL
test_data$CUE44_GenImp10_Homosexual..vs..heterosexual._Abstract_2=NULL
test_data$CUE45_GenImp11_Popular..vs..unpopular._Abstract_2=NULL
test_data$CUE46_GenImp12_Selfish..vs..unselfish._Abstract_2=NULL
test_data$CUE47_GenImp13_Ill.looking..vs..healthy.looking._Abstract_2=NULL
library('lars')
y_train <- as.matrix(train_data[,1])
X_train <- as.matrix(train_data[,2:57])
fit <- lars(X_train, y_train, type="lasso")
#summary(fit)
best_step <- fit$df[which.min(fit$RSS)] # select a step with a minimum error
X_test <- as.matrix(test_data[,2:57])  # make predictions
predictions_all <- predict(fit, X_test, s=best_step, type="fit")
cor.test(test_data$Risk, predictions_all$fit); # summarize accuracy
qplot(test_data$Risk, predictions_all$fit, xlab = "Actual HIV Risk", ylab = "Predicted HIV Risk",
xlim = c(1,7), ylim = c(1,7), asp = 1) +
theme(text = element_text(size=20))
library('lars')
# confining the dataset to the concrete cues: i.e. where Abstract_0
train_data$CUE2_Appearance2_Lot.of..vs..no..body.adornment_Abstract_0=NULL
train_data$CUE8_Appearance8_Dark..vs..bright..clothes_Abstract_0=NULL
train_data$CUE12_Body3_Overweight..vs..underweight._Abstract_0=NULL
train_data$CUE14_Body5_Tall..vs.low..height_Abstract_0=NULL
train_data$CUE15_Eyes1_Dark..vs..no.dark..rings.under.eyes_Abstract_0=NULL
train_data$CUE16_Eyes2_Reddened..vs..non.reddened..eyes_Abstract_0=NULL
train_data$CUE17_Eyes3_Dark..vs..bright..eyes_Abstract_0=NULL
train_data$CUE22_Face5_Round..vs..narrow..face_Abstract_0=NULL
train_data$CUE26_Face9_Red..vs..pale..cheeks_Abstract_0=NULL
train_data$CUE27_Face10_Narrow..vs..full..jaws_Abstract_0=NULL
train_data$CUE31_Face14_Reddened..vs..non.reddened..face_Abstract_0=NULL
train_data$CUE33_Face16_Symmetric..vs..unsymmetric..face_Abstract_0=NULL
train_data$CUE49_Hair2_Long..vs..short..hair_Abstract_0=NULL
train_data$CUE51_Hair4_Dark..vs..bright..hair_Abstract_0=NULL
train_data$CUE52_Mouth1_Smile..vs..non.smile._Abstract_0=NULL
train_data$CUE54_Mouth3_Full..vs..narrow..lips_Abstract_0=NULL
train_data$CUE55_Set1_Pallid..vs..colorful..background_Abstract_0=NULL
train_data$CUE57_Set3_Alcohol..vs..no.alcohol..visible_Abstract_0=NULL
train_data$CUE58_Set4_Picture.taken.inside..vs..outside._Abstract_0=NULL
train_data$CUE59_Set5_Picture.taken.in.nature..vs..civilization._Abstract_0=NULL
train_data$CUE60_Set6_Cigarettes..vs..no.cigarettes..visible_Abstract_0=NULL
train_data$CUE61_Set7_Food..vs..no.food..visible_Abstract_0=NULL
train_data$CUE63_Set9_During.sports.activities..vs..not._Abstract_0=NULL
train_data$CUE65_Skin2_Pale..vs..tanned..skin_Abstract_0=NULL
train_data$CUE66_Skin3_Pimply..vs..pimple.free..skin_Abstract_0=NULL
train_data$CUE67_Skin4_Many..vs..few..skin.folds_Abstract_0=NULL
train_data$CUE68_Skin5_Spotty..vs..spot.free..skin_Abstract_0=NULL
train_data$CUE69_Skin6_Greasy..vs..dry..skin_Abstract_0=NULL
train_data$CUE70_Skin7_Lots.of..vs..no..skin.visible_Abstract_0=NULL
train_data$CUE72_View2_Averted..vs..front.facing..gaze_Abstract_0=NULL
l = length(train_data)
y_train <- as.matrix(train_data[,1])
X_train <- as.matrix(train_data[,2:l])
fit <- lars(X_train, y_train, type="lasso")
#summary(fit)
best_step <- fit$df[which.min(fit$RSS)] # select a step with a minimum error
# confining the dataset to the concrete cues: i.e. where Abstract_0
test_data$CUE2_Appearance2_Lot.of..vs..no..body.adornment_Abstract_0=NULL
test_data$CUE8_Appearance8_Dark..vs..bright..clothes_Abstract_0=NULL
test_data$CUE12_Body3_Overweight..vs..underweight._Abstract_0=NULL
test_data$CUE14_Body5_Tall..vs.low..height_Abstract_0=NULL
test_data$CUE15_Eyes1_Dark..vs..no.dark..rings.under.eyes_Abstract_0=NULL
test_data$CUE16_Eyes2_Reddened..vs..non.reddened..eyes_Abstract_0=NULL
test_data$CUE17_Eyes3_Dark..vs..bright..eyes_Abstract_0=NULL
test_data$CUE22_Face5_Round..vs..narrow..face_Abstract_0=NULL
test_data$CUE26_Face9_Red..vs..pale..cheeks_Abstract_0=NULL
test_data$CUE27_Face10_Narrow..vs..full..jaws_Abstract_0=NULL
test_data$CUE31_Face14_Reddened..vs..non.reddened..face_Abstract_0=NULL
test_data$CUE33_Face16_Symmetric..vs..unsymmetric..face_Abstract_0=NULL
test_data$CUE49_Hair2_Long..vs..short..hair_Abstract_0=NULL
test_data$CUE51_Hair4_Dark..vs..bright..hair_Abstract_0=NULL
test_data$CUE52_Mouth1_Smile..vs..non.smile._Abstract_0=NULL
test_data$CUE54_Mouth3_Full..vs..narrow..lips_Abstract_0=NULL
test_data$CUE55_Set1_Pallid..vs..colorful..background_Abstract_0=NULL
test_data$CUE57_Set3_Alcohol..vs..no.alcohol..visible_Abstract_0=NULL
test_data$CUE58_Set4_Picture.taken.inside..vs..outside._Abstract_0=NULL
test_data$CUE59_Set5_Picture.taken.in.nature..vs..civilization._Abstract_0=NULL
test_data$CUE60_Set6_Cigarettes..vs..no.cigarettes..visible_Abstract_0=NULL
test_data$CUE61_Set7_Food..vs..no.food..visible_Abstract_0=NULL
test_data$CUE63_Set9_During.sports.activities..vs..not._Abstract_0=NULL
test_data$CUE65_Skin2_Pale..vs..tanned..skin_Abstract_0=NULL
test_data$CUE66_Skin3_Pimply..vs..pimple.free..skin_Abstract_0=NULL
test_data$CUE67_Skin4_Many..vs..few..skin.folds_Abstract_0=NULL
test_data$CUE68_Skin5_Spotty..vs..spot.free..skin_Abstract_0=NULL
test_data$CUE69_Skin6_Greasy..vs..dry..skin_Abstract_0=NULL
test_data$CUE70_Skin7_Lots.of..vs..no..skin.visible_Abstract_0=NULL
test_data$CUE72_View2_Averted..vs..front.facing..gaze_Abstract_0=NULL
X_test <- as.matrix(test_data[,2:l])  # make predictions
predictions <- predict(fit, X_test, s=best_step, type="fit")
cor.test(test_data$Risk, predictions$fit); # summarize accuracy
qplot(test_data$Risk, predictions$fit, xlab = "Actual HIV Risk", ylab = "Predicted HIV Risk",
xlim = c(1,7), ylim = c(1,7), asp = 1) +
theme(text = element_text(size=20))
rm(list = ls())
train_data = read.csv("setA_001-120.txt", header =TRUE, sep = "\t");
traindf = data.frame(matrix(ncol = 0, nrow = 120))
traindf$Risk <- train_data$Risk
traindf$SelfConfident <- train_data$CUE35_GenImp1_Self.confident..vs..not._Abstract_2
traindf$Cautious <-train_data$CUE36_GenImp2_Cautious..vs..risk.seeking._Abstract_2
traindf$Uneducated <-train_data$CUE37_GenImp3_Uneducated..vs..educated._Abstract_2
traindf$Southern <-train_data$CUE38_GenImp4_Southern..vs..nordic..type_Abstract_1
traindf$Sporty <-train_data$CUE39_GenImp5_Sporty..vs..unsporty._Abstract_2
traindf$Scruffy <-train_data$CUE40_GenImp6_Scruffy..vs..kempt._Abstract_2
traindf$Likeable <-train_data$CUE41_GenImp7_Likeable..vs..unsympathetic._Abstract_2
traindf$Attractive <-train_data$CUE42_GenImp8_Attractive..vs..unattractive._Abstract_2
traindf$Irresponsible <-train_data$CUE43_GenImp9_Irresponsible..vs..responsible._Abstract_2
traindf$Homosexual <-train_data$CUE44_GenImp10_Homosexual..vs..heterosexual._Abstract_2
traindf$Popular <-train_data$CUE45_GenImp11_Popular..vs..unpopular._Abstract_2
traindf$Selfish <-train_data$CUE46_GenImp12_Selfish..vs..unselfish._Abstract_2
traindf$Ill.looking <-train_data$CUE47_GenImp13_Ill.looking..vs..healthy.looking._Abstract_2
corrs_traindf <- cor(traindf)
rm(train_data, traindf)
test_data = read.csv("setB_121-240.txt", header =TRUE, sep = "\t");
testdf = data.frame(matrix(ncol = 0, nrow = 120))
testdf$Risk <- test_data$Risk
testdf$SelfConfident <- test_data$CUE35_GenImp1_Self.confident..vs..not._Abstract_2
testdf$Cautious <-test_data$CUE36_GenImp2_Cautious..vs..risk.seeking._Abstract_2
testdf$Uneducated <-test_data$CUE37_GenImp3_Uneducated..vs..educated._Abstract_2
testdf$Southern <-test_data$CUE38_GenImp4_Southern..vs..nordic..type_Abstract_1
testdf$Sporty <-test_data$CUE39_GenImp5_Sporty..vs..unsporty._Abstract_2
testdf$Scruffy <-test_data$CUE40_GenImp6_Scruffy..vs..kempt._Abstract_2
testdf$Likeable <-test_data$CUE41_GenImp7_Likeable..vs..unsympathetic._Abstract_2
testdf$Attractive <-test_data$CUE42_GenImp8_Attractive..vs..unattractive._Abstract_2
testdf$Irresponsible <-test_data$CUE43_GenImp9_Irresponsible..vs..responsible._Abstract_2
testdf$Homosexual <-test_data$CUE44_GenImp10_Homosexual..vs..heterosexual._Abstract_2
testdf$Popular <-test_data$CUE45_GenImp11_Popular..vs..unpopular._Abstract_2
testdf$Selfish <-test_data$CUE46_GenImp12_Selfish..vs..unselfish._Abstract_2
testdf$Ill.looking <-test_data$CUE47_GenImp13_Ill.looking..vs..healthy.looking._Abstract_2
corrs_testdf <- cor(testdf)
rm(test_data, testdf)
cor(corrs_testdf[1,2:14], corrs_traindf[1,2:14])
riskratings <- read.delim("~/Desktop/riskratings.txt", header=FALSE)
View(riskratings)
install.packages("psych")
library(psych)
ICC(riskratings,missing=TRUE,alpha=.05)
ICC(riskratings.T,missing=TRUE,alpha=.05)
ICC(t(riskratings),missing=TRUE,alpha=.05)
icc(ratings = riskratings, model="oneway",type = "consistency", unit = "single")
ICC(ratings = riskratings, model="oneway",type = "consistency", unit = "single")
sf <- matrix(c(9,    2,   5,    8,
6,    1,   3,    2,
8,    4,   6,    8,
7,    1,   2,    6,
10,   5,   6,    9,
6,   2,   4,    7),
ncol=4,byrow=TRUE)
View(sf)
ICC(sf,missing=TRUE,alpha=.05)
View(sf)
View(riskratings)
ICC(riskratings,missing=TRUE,alpha=.05)
riskratings <- read.delim("~/Desktop/riskratings.txt", header=FALSE)
View(riskratings)
ICC(riskratings,missing=TRUE,alpha=.05)
riskratings2 <- read.delim("~/Desktop/riskratings2.txt", header=FALSE)
View(riskratings2)
ICC(riskratings,missing=TRUE,alpha=.05)
View(riskratings2)
ICC(riskratings2,missing=TRUE,alpha=.05)
riskratings2 <- read.delim("~/Desktop/riskratings2.txt", header=FALSE)
View(riskratings2)
ICC(riskratings2,missing=TRUE,alpha=.05)
riskratings2 <- read.delim("~/Desktop/riskratings2.txt", header=FALSE)
View(riskratings2)
ICC(riskratings2,missing=TRUE,alpha=.05)
alpha(riskratings2)
a <-alpha(riskratings2)
summary(a)
